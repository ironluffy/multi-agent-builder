---
id: WP03.2
task_id: T034
title: Implement Agent constructor with dependency injection in src/core/Agent.ts
phase: Phase 3 - User Story 1 (MVP)
lane: done
status: pending
created_at: 2025-11-21
started_at: 2025-11-22T13:37:04Z
completed_at: 2025-11-22T13:42:49Z
estimated_time: 25min
actual_time: null
depends_on: [T033]
files_modified: []
---

# WP03.2: Implement Agent constructor with dependency injection [US1]

## Objective

Fully implement the Agent class constructor with dependency injection pattern, initializing all required dependencies and agent properties.

## File Paths

- `src/core/Agent.ts`

## Work Content

1. Enhance Agent constructor to accept:
   - SharedDatabase instance
   - Logger instance
   - Anthropic client
   - AgentRepository instance
   - BudgetService instance (optional)
2. Initialize agent properties:
   - Generate UUID for id
   - Set initial status to 'idle'
   - Initialize depth_level
   - Set parent_id if provided
3. Validate required dependencies
4. Add constructor parameter validation
5. Create factory method for easier instantiation

## Acceptance Criteria

- [ ] Constructor accepts all required dependencies
- [ ] Dependencies validated (throw error if missing)
- [ ] Agent properties initialized correctly
- [ ] UUID generated for agent id
- [ ] Factory method created for convenience
- [ ] Constructor documented with JSDoc

## Dependencies

Depends on T033 (Agent class skeleton exists).

## Parallel Execution

Sequential after T033, but can be parallel with T036 and T037.

## Unit Tests

Unit tests in tests/unit/core/Agent.test.ts for constructor validation and initialization.

## Git History

**Commits**: Include [WP03.2] in commit message

## Activity Log

- 2025-11-21: Task created

- 2025-11-22T13:37:04Z: Moved from planned to doing

- 2025-11-22T13:37:04Z: Moved from doing to for_review

- 2025-11-22T13:42:49Z: Moved from for_review to done
